<?xml version="1.0" encoding="UTF-8"?>
<report_info>
  <scan_info>
    <app_path>/home/jym/rails/gitlab-development-kit/gitlab</app_path>
    <ruby_version>2.2.1</ruby_version>
    <rails_version>4.1.9</rails_version>
    <brakeman_version>3.0.5</brakeman_version>
    <report_generation_time>2015-07-14 08:04:54 +0800</report_generation_time>
    <start_time>2015-07-14 08:04:39 +0800</start_time>
    <end_time>2015-07-14 08:04:54 +0800</end_time>
    <duration>14.874376089</duration>
    <checks>BasicAuth,ContentTag,CreateWith,CrossSiteScripting,DefaultRoutes,Deserialize,DetailedExceptions,DigestDoS,EscapeFunction,Evaluation,Execute,FileAccess,FileDisclosure,FilterSkipping,ForgerySetting,HeaderDoS,I18nXSS,JRubyXML,JSONEncoding,JSONParsing,LinkTo,LinkToHref,MailTo,MassAssignment,ModelAttrAccessible,ModelAttributes,ModelSerialize,NestedAttributes,NumberToCurrency,QuoteTableName,Redirect,RegexDoS,Render,RenderDoS,RenderInline,ResponseSplitting,SQL,SQLCVEs,SSLVerify,SafeBufferManipulation,SanitizeMethods,SelectTag,SelectVulnerability,Send,SendFile,SessionSettings,SimpleFormat,SingleQuotes,SkipBeforeFilter,StripTags,SymbolDoSCVE,TranslateBug,UnsafeReflection,ValidationRegex,WithoutProtection,XMLDoS,YAMLParsing</checks>
  </scan_info>
  <warnings>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>7e012ec5904e0975cc8d801737b864eff4f5b8a12845b99648e68135aeb652a4</fingerprint>
      <message>Possible command injection</message>
      <file>lib/gitlab/backend/shell.rb</file>
      <line>165</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>IO.popen(["#{gitlab_shell_path}/bin/gitlab-keys", "batch-add-keys"], "w")</code>
      <render_path></render_path>
      <location>type,method,class,Gitlab::Shell,method,batch_add_keys</location>
      <user_input>gitlab_shell_path</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>8bfcd775a5260c34180bbf3115403c68dce1d4490f9cd7e66415b90d5fbf1f55</fingerprint>
      <message>Possible command injection</message>
      <file>lib/backup/manager.rb</file>
      <line>85</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>Kernel.system(*["rm", "#{timestamp}_gitlab_backup.tar"])</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Manager,method,remove_old</location>
      <user_input>timestamp</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>92ca0fda9a98405bc38bce7e2ab6a6cc80420a13b2e9c23e03028e97c2cea5c2</fingerprint>
      <message>Possible command injection</message>
      <file>lib/backup/manager.rb</file>
      <line>120</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>Kernel.system(*["tar", "-xf", "#{(File.join("#{Dir.glob("*_gitlab_backup.tar").each.map do
 f.split(/_/).first.to_i
 end.first}_gitlab_backup.tar") or File.join((ENV["BACKUP"] + "_gitlab_backup.tar")))}"])</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Manager,method,unpack</location>
      <user_input>Dir.glob("*_gitlab_backup.tar").each.map do
 f.split(/_/).first.to_i
 end.first</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>0d5a2221da97802c9b3a036e45ff143648641dda8976fa7a2b31e37bff4e8cfb</fingerprint>
      <message>Possible command injection</message>
      <file>lib/backup/repository.rb</file>
      <line>73</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>system(*(["tar", "-xf", "#{path_to_bundle(project)}", "-C", "#{path_to_repo(project)}"] or ["git", "init", "--bare", "#{path_to_repo(project)}"]), silent)</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Repository,method,restore</location>
      <user_input>path_to_repo(project)</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>f0fb36990cb2b0d4c1ea0cb397ffa1c96a9a8241f2f0fdff285224251fba72ae</fingerprint>
      <message>Possible command injection</message>
      <file>lib/backup/repository.rb</file>
      <line>92</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>system(*["git", "clone", "--bare", "#{path_to_bundle(ProjectWiki.new(project))}", "#{path_to_repo(ProjectWiki.new(project))}"], silent)</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Repository,method,restore</location>
      <user_input>ProjectWiki.new(project)</user_input>
      <confidence>High</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>498e460868b5105288305058a734331f8f04f635c5d03f1214b17f03f0d8eae5</fingerprint>
      <message>Possible command injection</message>
      <file>lib/backup/repository.rb</file>
      <line>104</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>system("#{Gitlab.config.gitlab_shell.path}/bin/create-hooks")</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Repository,method,restore</location>
      <user_input>Gitlab.config.gitlab_shell.path</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Command Injection</warning_type>
      <warning_code>14</warning_code>
      <fingerprint>995a6e117d9dd11a082c39a96a67f3887c1b1c234db112ea1b329cb49e647fbc</fingerprint>
      <message>Possible command injection</message>
      <file>lib/gitlab/satellite/satellite.rb</file>
      <line>38</line>
      <link>http://brakemanscanner.org/docs/warning_types/command_injection/</link>
      <code>popen(["git", "clone", "--", "#{project.repository.path_to_repo}", "#{path}"], Gitlab.config.satellites.path)</code>
      <render_path></render_path>
      <location>type,method,class,Gitlab::Satellite::Satellite,method,create</location>
      <user_input>path</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>File Access</warning_type>
      <warning_code>16</warning_code>
      <fingerprint>87526ba3cf2b7e2ee9f0f0ea555c84ae4031b353fd8ced591d7d7ff907a4e1eb</fingerprint>
      <message>Model attribute used in file name</message>
      <file>lib/backup/repository.rb</file>
      <line>89</line>
      <link>http://brakemanscanner.org/docs/warning_types/file_access/</link>
      <code>FileUtils.rm_rf(path_to_repo(ProjectWiki.new(project)))</code>
      <render_path></render_path>
      <location>type,method,class,Backup::Repository,method,restore</location>
      <user_input>ProjectWiki.new(project)</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>87</warning_code>
      <fingerprint>5140b4ad4a378a7ca8084f995f4838f453c82a98eceb9b5c80e00b299c5c199d</fingerprint>
      <message>Rails 4.1.9 does not encode JSON keys (CVE-2015-3226). Upgrade to Rails version 4.1.11</message>
      <file>Gemfile.lock</file>
      <line>425</line>
      <link>https://groups.google.com/d/msg/rubyonrails-security/7VlB_pck3hU/3QZrGIaQW6cJ</link>
      <code></code>
      <render_path></render_path>
      <location></location>
      <user_input></user_input>
      <confidence>High</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>76</warning_code>
      <fingerprint>e74a0dfb959869db00a2613657b95bf22bd8a055827b49739e2ddafceae2748b</fingerprint>
      <message>Model attribute used in regex</message>
      <file>app/models/commit.rb</file>
      <line>76</line>
      <link>http://brakemanscanner.org/docs/warning_types/denial_of_service/</link>
      <code>/\n      (?:#{Project.reference_pattern}#{reference_prefix})?\n      (?&lt;commit&gt;\h{6,40})\n    /x</code>
      <render_path></render_path>
      <location>type,method,class,Commit,method,Commit.reference_pattern</location>
      <user_input>Project.reference_pattern</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>76</warning_code>
      <fingerprint>a2f3a69f5da0ff40a705c6b1791c59ec8aa12c8bf02b3a289118b3d6d95959bf</fingerprint>
      <message>Model attribute used in regex</message>
      <file>app/models/commit_range.rb</file>
      <line>45</line>
      <link>http://brakemanscanner.org/docs/warning_types/denial_of_service/</link>
      <code>/\n      (?:#{Project.reference_pattern}#{reference_prefix})?\n      (?&lt;commit_range&gt;#{/\h{6,40}\.{2,3}\h{6,40}/})\n    /x</code>
      <render_path></render_path>
      <location>type,method,class,CommitRange,method,CommitRange.reference_pattern</location>
      <user_input>Project.reference_pattern</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>76</warning_code>
      <fingerprint>5e1798dfede118ae346ee41b7121c6f1d4022b914edbd6c9f7e5d80c98a19de3</fingerprint>
      <message>Model attribute used in regex</message>
      <file>app/models/issue.rb</file>
      <line>66</line>
      <link>http://brakemanscanner.org/docs/warning_types/denial_of_service/</link>
      <code>/\n      (#{Project.reference_pattern})?\n      #{Regexp.escape(reference_prefix)}(?&lt;issue&gt;\d+)\n    /x</code>
      <render_path></render_path>
      <location>type,method,class,Issue,method,Issue.reference_pattern</location>
      <user_input>Project.reference_pattern</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>76</warning_code>
      <fingerprint>a4ec324048e0c33bda0c5f96bbe019ce9054f85b28693608174422809a1f15ef</fingerprint>
      <message>Model attribute used in regex</message>
      <file>app/models/merge_request.rb</file>
      <line>148</line>
      <link>http://brakemanscanner.org/docs/warning_types/denial_of_service/</link>
      <code>/\n      (#{Project.reference_pattern})?\n      #{Regexp.escape(reference_prefix)}(?&lt;merge_request&gt;\d+)\n    /x</code>
      <render_path></render_path>
      <location>type,method,class,MergeRequest,method,MergeRequest.reference_pattern</location>
      <user_input>Project.reference_pattern</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>76</warning_code>
      <fingerprint>807c9d884df3205d254f7cabeaff12c9c257d8aa701f8f5e0fbfe8ced681355e</fingerprint>
      <message>Model attribute used in regex</message>
      <file>app/models/snippet.rb</file>
      <line>64</line>
      <link>http://brakemanscanner.org/docs/warning_types/denial_of_service/</link>
      <code>/\n      (#{Project.reference_pattern})?\n      #{Regexp.escape(reference_prefix)}(?&lt;snippet&gt;\d+)\n    /x</code>
      <render_path></render_path>
      <location>type,method,class,Snippet,method,Snippet.reference_pattern</location>
      <user_input>Project.reference_pattern</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>a11292ae72a72e743b617062ada352e4f6257a86b17cfa1e8299be4f28addb50</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/controllers/profiles/keys_controller.rb</file>
      <line>43</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>User.find_by_username(params[:username]).all_ssh_keys.join("\n")</code>
      <render_path></render_path>
      <location>type,method,class,Profiles::KeysController,method,get_keys</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>bf6ec28612481077e6bf204af7e60545d1b46573d6e117a2013f33745696acb7</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/controllers/projects/commit_controller.rb</file>
      <line>27</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).commit(params[:id]).to_diff</code>
      <render_path></render_path>
      <location>type,method,class,Projects::CommitController,method,show</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>a97a9aafeb3a7c9cb836b52294734f98c0c41f646bfa2e1d0cef8477d01ea34f</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/controllers/projects/commit_controller.rb</file>
      <line>28</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).commit(params[:id]).to_patch</code>
      <render_path></render_path>
      <location>type,method,class,Projects::CommitController,method,show</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>9f3ec15c655687199b43fa1d94293c52742271e95a22ee0e2ebcab7d57917441</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/controllers/projects/merge_requests_controller.rb</file>
      <line>53</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).to_diff(current_user)</code>
      <render_path></render_path>
      <location>type,method,class,Projects::MergeRequestsController,method,show</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>271a6519150fbabebaadc5f4a0dc6c369089c408d68c26d1f522c29b3cf7fdf2</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/controllers/projects/merge_requests_controller.rb</file>
      <line>54</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).to_patch(current_user)</code>
      <render_path></render_path>
      <location>type,method,class,Projects::MergeRequestsController,method,show</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>File Access</warning_type>
      <warning_code>16</warning_code>
      <fingerprint>75636355791a922bb880f1d0d7986f3fc7078645f1b5b57f78a92b099ea3a339</fingerprint>
      <message>Parameter value used in file name</message>
      <file>app/controllers/help_controller.rb</file>
      <line>30</line>
      <link>http://brakemanscanner.org/docs/warning_types/file_access/</link>
      <code>send_file(Rails.root.join("doc", clean_path_info(path_params[:category]), "#{path_params[:file]}.#{params[:format]}"), :disposition =&gt; "inline")</code>
      <render_path></render_path>
      <location>type,method,class,HelpController,method,show</location>
      <user_input>params[:format]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>File Access</warning_type>
      <warning_code>16</warning_code>
      <fingerprint>c20e168b769ad3d20fe368422777d0ea450b81e2ad2891bca28bd6fde293ce6f</fingerprint>
      <message>Parameter value used in file name</message>
      <file>app/controllers/projects/repositories_controller.rb</file>
      <line>23</line>
      <link>http://brakemanscanner.org/docs/warning_types/file_access/</link>
      <code>send_file(ArchiveRepositoryService.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), params[:ref], params[:format]).execute)</code>
      <render_path></render_path>
      <location>type,method,class,Projects::RepositoriesController,method,archive</location>
      <user_input>params[:format]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>File Access</warning_type>
      <warning_code>16</warning_code>
      <fingerprint>3ab1b7e7bfc480f866ade9e054593e21f7945c0a56d163f4a502ea90d76563c7</fingerprint>
      <message>Model attribute used in file name</message>
      <file>app/controllers/projects/wikis_controller.rb</file>
      <line>21</line>
      <link>http://brakemanscanner.org/docs/warning_types/file_access/</link>
      <code>send_file(ProjectWiki.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), current_user).find_file(params[:id], params[:version_id]).on_disk_path, :disposition =&gt; "inline")</code>
      <render_path></render_path>
      <location>type,method,class,Projects::WikisController,method,show</location>
      <user_input>ProjectWiki.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), current_user).find_file(params[:id], params[:version_id]).on_disk_path</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>File Access</warning_type>
      <warning_code>16</warning_code>
      <fingerprint>091125222db7d91609c9bf0bed4752e485add758ec41ce4bddfa3cb68d959ece</fingerprint>
      <message>Parameter value used in file name</message>
      <file>app/controllers/uploads_controller.rb</file>
      <line>17</line>
      <link>http://brakemanscanner.org/docs/warning_types/file_access/</link>
      <code>send_file(upload_model.find(params[:id]).send(upload_mount).file.path, :disposition =&gt; (("inline" or "attachment")))</code>
      <render_path></render_path>
      <location>type,method,class,UploadsController,method,show</location>
      <user_input>params[:id]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Denial of Service</warning_type>
      <warning_code>88</warning_code>
      <fingerprint>ab42647fbdea61e25c4b794e82a8b315054e2fac4328bb3fd4be6a744889a987</fingerprint>
      <message>Rails 4.1.9 is vulnerable to denial of service via XML parsing (CVE-2015-3227). Upgrade to Rails version 4.1.11</message>
      <file>Gemfile.lock</file>
      <line>425</line>
      <link>https://groups.google.com/d/msg/rubyonrails-security/bahr2JLnxvk/x4EocXnHPp8J</link>
      <code></code>
      <render_path></render_path>
      <location></location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>2b796fe3aa99230dac55f30e19da09b95b33905ceb4c149cb558f7a17df17b02</fingerprint>
      <message>Unescaped parameter value</message>
      <file>app/views/projects/blob/preview.html.haml</file>
      <line>9</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>render_markup(project.repository.blob_at(project.repository.commit(@ref).id, @path).name, params[:content])</code>
      <render_path>["Projects::BlobController#preview"]</render_path>
      <location>type,template,template,projects/blob/preview (Projects::BlobController#preview)</location>
      <user_input>params[:content]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>7446c1f1920425f58bfde4ecea3954dba85065805cba93297bf190771f6481d8</fingerprint>
      <message>Unescaped parameter value</message>
      <file>app/views/projects/commits/show.html.haml</file>
      <line>33</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Javascript.render_with_options("CommitsList.init(\"#{@ref}", #{(params[:limit] or 40)});", _hamlout.options))</code>
      <render_path>["Projects::CommitsController#show"]</render_path>
      <location>type,template,template,projects/commits/show (Projects::CommitsController#show)</location>
      <user_input>params[:limit]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>c264b34871b0b5db695c4f7d568b18ebc582ed2d5da3ad83523b34458a550c39</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/empty.html.haml</file>
      <line>33</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git clone #{content_tag(:span, default_url_to_repo, :class =&gt; "clone")}
cd #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).path}
touch README.md
git add README.md
git commit -m "add README"
git push -u origin master
", _hamlout.options))</code>
      <render_path>["ProjectsController#show"]</render_path>
      <location>type,template,template,projects/empty (ProjectsController#show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).path</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>f662284eebe9e5123d5a43561108332bb45d43f3b557cc63c1ce82676848292a</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/_show.html.haml</file>
      <line>76</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Javascript.render_with_options("var merge_request;\n\nmerge_request = new MergeRequest({\n  url_to_automerge_check: \"#{automerge_check_namespace_project_merge_request_path(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).namespace, Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]))}",
  check_enable: #{if Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).unchecked? then
  "true"
else
  "false"
end},
  url_to_ci_check: "#{ci_status_namespace_project_merge_request_path(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).namespace, Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]))}",
  ci_enable: #{if Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).ci_service then
  "true"
else
  "false"
end},
  current_status: "#{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).automerge_status}",
  action: "#{controller.action_name}"
});", _hamlout.options))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show"]</render_path>
      <location>type,template,template,projects/merge_requests/_show (Template:projects/merge_requests/show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>521074098e58b49efa0464ef37e313b1d22d788793a86b1001c105e5e358d856</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/show/_how_to_merge.html.haml</file>
      <line>16</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git fetch #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_project.http_url_to_repo} #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch}
git checkout -b #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_project_path}-#{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch} FETCH_HEAD", _hamlout.options))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_how_to_merge (Template:projects/merge_requests/_show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>868ddf7f591f173fad844fb15ddd632e9f7795da1b8d3c91969b4234244fe80f</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/show/_how_to_merge.html.haml</file>
      <line>23</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git checkout #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).target_branch}
git merge --no-ff #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_project_path}-#{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch}
git push origin #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).target_branch}", _hamlout.options))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_how_to_merge (Template:projects/merge_requests/_show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>7f1ad56d93483648523bcb2406efaf548e827f6a477eb6790dbe5a9142a6a60e</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/show/_how_to_merge.html.haml</file>
      <line>33</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git fetch origin\ngit checkout -b #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch} origin/#{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch}", _hamlout.options))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_how_to_merge (Template:projects/merge_requests/_show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>7f27ec682821aab2414a900c1557415d5feb6833f717c8c5ac164e35552d756e</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/show/_how_to_merge.html.haml</file>
      <line>39</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git checkout #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).target_branch}
git merge --no-ff #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).source_branch}
git push origin #{Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).target_branch}
", _hamlout.options))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_how_to_merge (Template:projects/merge_requests/_show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>b64a5a1a189748e1a96fd6f6c013cd58293f7f07e24adec590dc16656d53b534</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/merge_requests/show/_state_widget.html.haml</file>
      <line>50</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>gfm(issues_sentence(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).closes_issues))</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_state_widget (Template:projects/merge_requests/_show)</location>
      <user_input>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>861d199d0dfd9ac174ee309da146d7398dc52982389f944b84b1f7b5e71c791e</fingerprint>
      <message>Unescaped model attribute</message>
      <file>app/views/projects/wikis/git_access.html.haml</file>
      <line>23</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Preserve.render_with_options("git clone #{content_tag(:span, default_url_to_repo(ProjectWiki.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), current_user)), :class =&gt; "clone")}
cd #{ProjectWiki.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), current_user).path}
", _hamlout.options))</code>
      <render_path>["Projects::WikisController#git_access"]</render_path>
      <location>type,template,template,projects/wikis/git_access (Projects::WikisController#git_access)</location>
      <user_input>ProjectWiki.new(Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")), current_user).path</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>2</warning_code>
      <fingerprint>545e4bb7c857001fd09072c07e1b3c8c3957b34e9605488872b4e1e319d22c33</fingerprint>
      <message>Unescaped parameter value</message>
      <file>app/views/search/_results.html.haml</file>
      <line>21</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting</link>
      <code>find_and_preserve(Haml::Filters::Javascript.render_with_options("$(\".search-results .term\").highlight(\"#{escape_javascript(params[:search])}");", _hamlout.options))</code>
      <render_path>["SearchController#show", "Template:search/show"]</render_path>
      <location>type,template,template,search/_results (Template:search/show)</location>
      <user_input>params[:search]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>4</warning_code>
      <fingerprint>bcee8cc2b9ad2ba69ddcbd881c27584b1d616427458cda5c8a3b6d56a3ec5b3e</fingerprint>
      <message>Unsafe parameter value in link_to href</message>
      <file>app/views/profiles/keys/_key_details.html.haml</file>
      <line>22</line>
      <link>http://brakemanscanner.org/docs/warning_types/link_to_href</link>
      <code>link_to("Remove", path_to_key(user.keys.find(params[:id]), (true or false)), :data =&gt; ({ :confirm =&gt; "Are you sure?" }), :method =&gt; :delete, :class =&gt; "btn btn-remove delete-key")</code>
      <render_path>["Admin::KeysController#show", "Template:admin/keys/show"]</render_path>
      <location>type,template,template,profiles/keys/_key_details (Template:admin/keys/show)</location>
      <user_input>params</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>7b28a2b1e058e85a733b910823e2bc539a31eeee6970de8daae289165ba52452</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/explore/projects/index.html.haml</file>
      <line>8</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; ProjectsFinder.new.execute(current_user).tagged_with(params[:tag]).where(:visibility_level =&gt; params[:visibility_level]).search(params[:search]).sort(@sort = params[:sort]).includes(:namespace).page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Explore::ProjectsController#index"]</render_path>
      <location>type,template,template,explore/projects/index (Explore::ProjectsController#index)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>df5c049fb05f94249c0d41654c708f9add3c4e7a238eb08e30f1f73823428626</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/explore/projects/starred.html.haml</file>
      <line>9</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; ProjectsFinder.new.execute(current_user).reorder("star_count DESC").page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Explore::ProjectsController#starred"]</render_path>
      <location>type,template,template,explore/projects/starred (Explore::ProjectsController#starred)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>4b6ba528033b2ad9ad1334a160e5ac66e04b10eff728efc0813a4ecbf403b68b</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/explore/projects/trending.html.haml</file>
      <line>15</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; TrendingProjectsFinder.new.execute(current_user).page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Explore::ProjectsController#trending"]</render_path>
      <location>type,template,template,explore/projects/trending (Explore::ProjectsController#trending)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>03d4d1e66298f64f3f41f3c68610fe0725aeb1809cf5f578d50c1050c3b93aec</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/profiles/history.html.haml</file>
      <line>8</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; current_user.recent_events.page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["ProfilesController#history"]</render_path>
      <location>type,template,template,profiles/history (ProfilesController#history)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>4253f9f704eecd1f980e75da4baa3947cadec8093841a60e97687a657c244c76</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/projects/issues/_issues.html.haml</file>
      <line>3</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; get_issues_collection.where(:iid =&gt; ($1)).full_search(params["issue_search"]).page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Projects::IssuesController#index", "Template:projects/issues/index"]</render_path>
      <location>type,template,template,projects/issues/_issues (Template:projects/issues/index)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>b9e8077493e7bfd1fa2e03f9e770d6a1be3e1527a2ab7e6750a9023cf8d001cb</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/projects/labels/index.html.haml</file>
      <line>12</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).labels.page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Projects::LabelsController#index"]</render_path>
      <location>type,template,template,projects/labels/index (Projects::LabelsController#index)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>e43086d1c54651be9952448601e146971608b824c28d1ea864620cd1ac0f6f05</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/projects/merge_requests/_merge_requests.html.haml</file>
      <line>3</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; get_merge_requests_collection.where(:iid =&gt; ($1)).full_search(params["issue_search"]).page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Projects::MergeRequestsController#index", "Template:projects/merge_requests/index"]</render_path>
      <location>type,template,template,projects/merge_requests/_merge_requests (Template:projects/merge_requests/index)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>7d6a0ded4273c7ac7547276160a5e3d03e9842f1fc208c29e43c29488153647a</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/projects/milestones/index.html.haml</file>
      <line>12</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(action =&gt; case params[:state]
when "all" then
  Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).milestones.order("state, due_date DESC")
when "closed" then
  Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).milestones.closed.order("due_date DESC")
else
  Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).milestones.active.order("due_date ASC")
end.includes(:project).page(params[:page]).per(PER_PAGE), {})</code>
      <render_path>["Projects::MilestonesController#index"]</render_path>
      <location>type,template,template,projects/milestones/index (Projects::MilestonesController#index)</location>
      <user_input>params[:page]</user_input>
      <confidence>Weak</confidence>
    </warning>
    <warning>
      <warning_type>Dynamic Render Path</warning_type>
      <warning_code>15</warning_code>
      <fingerprint>01b5a820e1dfd8426d490b2db4f2e7aa3e577b01d73b2d57839047cf04011b86</fingerprint>
      <message>Render path contains parameter value</message>
      <file>app/views/search/_results.html.haml</file>
      <line>17</line>
      <link>http://brakemanscanner.org/docs/warning_types/dynamic_render_path/</link>
      <code>render(partial =&gt; "search/results/#{(((params[:scope] or "blobs") or "snippet_blobs") or "projects").singularize}", { :collection =&gt; (if @project then
  unless ["blobs", "notes", "issues", "merge_requests", "wiki_blobs"].include?(params[:scope]) then
    @scope = "blobs"
  end
  Search::ProjectService.new((Project.find_by(:id =&gt; params[:project_id]) or nil), current_user, params).execute
else
  if @show_snippets then
    unless ["snippet_blobs", "snippet_titles"].include?((params[:scope] or "blobs")) then
      @scope = "snippet_blobs"
    end
    Search::SnippetService.new(current_user, params).execute
  else
    unless ["projects", "issues", "merge_requests"].include?(((params[:scope] or "blobs") or "snippet_blobs")) then
      @scope = "projects"
    end
    Search::GlobalService.new(current_user, params).execute
  end
end).objects((((params[:scope] or "blobs") or "snippet_blobs") or "projects"), params[:page]) })</code>
      <render_path>["SearchController#show", "Template:search/show"]</render_path>
      <location>type,template,template,search/_results (Template:search/show)</location>
      <user_input>params[:scope]</user_input>
      <confidence>Medium</confidence>
    </warning>
    <warning>
      <warning_type>Cross Site Scripting</warning_type>
      <warning_code>84</warning_code>
      <fingerprint>f44189ab038317c8c7fbe80f70039f229279680599305833c5dcd9da34630ed3</fingerprint>
      <message>Unescaped model attribute rendered inline</message>
      <file>app/views/projects/merge_requests/show/_mr_accept.html.haml</file>
      <line>34</line>
      <link>http://brakemanscanner.org/docs/warning_types/cross_site_scripting/</link>
      <code>Project.find_with_namespace([params[:namespace_id], "/", params[:id]].join("")).merge_requests.find_by!(:iid =&gt; params[:id]).merge_commit_message</code>
      <render_path>["Projects::MergeRequestsController#show", "Template:projects/merge_requests/show", "Template:projects/merge_requests/_show", "Template:projects/merge_requests/show/_state_widget"]</render_path>
      <location>type,template,template,projects/merge_requests/show/_mr_accept (Template:projects/merge_requests/show/_state_widget)</location>
      <user_input></user_input>
      <confidence>Medium</confidence>
    </warning>
  </warnings>
  <ignored_warnings>
  </ignored_warnings>
  <errors>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/groups/group_members/index.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/projects/diffs/_diffs.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/projects/graphs/show.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/projects/merge_requests/_new_compare.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/projects/new.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/projects/project_members/index.html.haml</location>
    </error>
    <error>
      <error_message>"coffee" filter's coffee_script dependency missing: try installing it or adding it to your Gemfile</error_message>
      <location>While compiling HAML in /home/jym/rails/gitlab-development-kit/gitlab/app/views/shared/_issuable_filter.html.haml</location>
    </error>
  </errors>
</report_info>
